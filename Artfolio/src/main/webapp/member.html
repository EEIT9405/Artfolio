<!DOCTYPE html>
<html>
<head>
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<link href="css/bootstrap.min.css" rel="stylesheet">
<script src="js/jquery-3.2.1.min.js"></script>
<script src="js/bootstrap.min.js"></script>
<title>Insert title here</title>

</head>
<body>
	<div id="mb">
		<ul class="nav nav-tabs" role="tablist">
			<li role="presentation"><a href="#like" aria-controls="like" role="tab" data-toggle="tab">like</a></li>
			<li role="presentation"><a href="#follow" aria-controls="follow" role="tab" data-toggle="tab">follow</a></li>
		</ul>
		<div class="tab-content">
			<div id="like" role="tabpanel" class="tab-pane">
				<form>
					<table>
						<thead>
							<tr>
								<th>wid</th>
								<th>url</th>
								<th>title</th>
								<th>date</th>
								<th></th>
							</tr>
						</thead>
						<tbody>
						</tbody>
					</table>
				</form>
			</div>
			<div id="follow" role="tabpanel" class="tab-pane">
				<form>
					<table>
						<thead>
							<tr>
								<th>icon</th>
								<th>mid</th>
								<th>name</th>
								<th>date</th>
								<th></th>
							</tr>
						</thead>
						<tbody>
						</tbody>
					</table>
				</form>
			</div>
		</div>
	</div>
	<script>
	$('table','#mb').addClass('table');
	$('ul>li>a','#mb').on('click',function (e) {
		  e.preventDefault();
		  $(this).tab('show');
		  $.get($(this).text()+'/get.controller',function(data){
			 if(data.str=="Like"){
				 var liketbody=$('#like tbody');
				 liketbody.get(0).innerHTML="";
				 for (var i=0;i<data.list.length;i++){
					 var tr=$('<tr></tr>');
					 $('<td>'+data.list[i].wid+'</td>').appendTo(tr);
					 $('<td>'+data.list[i].url+'</td>').appendTo(tr);
					 $('<td>'+data.list[i].title+'</td>').appendTo(tr);
					 $('<td>'+new Date(data.list[i].date).toDateString()+'</td>').appendTo(tr);
					 $('<td><input type="button" value="delete"></td>').appendTo(tr);
					 tr.prependTo(liketbody);
				 }
			 }else if(data.str=="Follow"){
				 var followtbody=$('#follow tbody');
				 followtbody.get(0).innerHTML="";
				 for (var i=0;i<data.list.length;i++){
					 var tr=$('<tr></tr>');
					 $('<td><img src="'+data.list[i].mphoto+'"></td>').appendTo(tr);
					 $('<td>'+data.list[i].mid+'</td>').appendTo(tr);
					 $('<td>'+data.list[i].name+'</td>').appendTo(tr);
					 $('<td>'+new Date(data.list[i].date).toDateString()+'</td>').appendTo(tr);
					 $('<td><input type="button" value="delete"></td>').appendTo(tr);
					 tr.prependTo(followtbody);
				 }
			 }else
				 alert('something goes wrong');
		  });
		});
		$('tbody','#like').on('click','input[value=delete]',function(){
			var tr=$(this).parents('tr');
			$.post('like/delete.controller',{wid:tr.children('td:nth-child(1)').text()},function(data){
				if(data!='' && !data.liked)
					tr.remove();
				else
					alert('error');
			});
		});
		$('tbody','#follow').on('click','input[value=delete]',function(){
			var tr=$(this).parents('tr');
			$.post('follow/delete.controller',{followid:tr.children('td:nth-child(2)').text()},function(data){
				if(data!='' && !data.followed)
					tr.remove();
				else
					alert('error');
			});
		});
	</script>
</body>
</html>